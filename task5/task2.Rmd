---
title: "Data Mining - Clustering"
output: html_notebook
---

### Data loading
```{r}
preprocess_data = function(path){
  original = as.data.frame(read.table(path, header=F))
  labels = as.array(original[,ncol(original)])+1
  original[,ncol(original)] = NULL
  scaled = as.data.frame(scale(original))
  dataset = list(original=original, labels=labels, scaled=scaled)
  return(dataset)
}

```


### k-Means
```{r}
k_means = function(dataset) {
  set.seed(20)
  kmeans_clusters = kmeans(dataset$scaled, length(levels(as.factor(dataset$labels))))
  kcl = kmeans_clusters$cluster
  return(kcl)
}

```

```{r}
install.packages("cluster")
suppressPackageStartupMessages(library(cluster))
```

```{r}
data = preprocess_data('datasets/2d-10c.dat')

           
dist.res <- dist(as.vector(data$original), method = "euclidean")

sil = rep(0, 20)
for(i in 2:20){
  clusters =  k_means(data)
  ss = silhouette(clusters, dist(data$original))
  sil[i] = mean(ss[, 3])
}
plot(1:20, sil, type = "b", pch = 19, 
     frame = FALSE, xlab = "Number of clusters k")
abline(v = which.max(sil), lty = 2)




silhouette_score = function(k){
  km = k_means(data)
  ss = silhouette(data.frame(km),  dist(data$original))
  return(mean(ss[, 3]))
}
k=c(2,3,4,5,6)
avg_sil <- sapply(k, silhouette_score)

plot(k, type='b', avg_sil, xlab='Number of clusters', ylab='Average Silhouette Scores', frame=FALSE)

```

