---
title: "Data Mining - Clustering"
output: html_notebook
---

### Data loading
```{r}
preprocess_data = function(path){
  original = as.data.frame(read.table(path, header=F))
  labels = as.array(original[,ncol(original)])+1
  original[,ncol(original)] = NULL
  scaled = as.data.frame(scale(original))
  dataset = list(original=original, labels=labels, scaled=scaled)
  return(dataset)
}

```


### k-Means
```{r}
k_means = function(dataset, cluster_nr) {
  set.seed(20)
  kmeans_clusters = kmeans(dataset$scaled, cluster_nr)
  return(kmeans_clusters)
}

```

```{r}
install.packages("cluster")
suppressPackageStartupMessages(library(cluster))
```

```{r}
data = preprocess_data('datasets/2d-10c.dat')
silhouette_means = c()
wss_means = c()
for (k in 2:20) {
  kcl = k_means(data, k)
  clusters = kcl$cluster
  wss = kcl$withinss
  current_silhouette = silhouette(clusters, dist(data$original, method = "euclidean"))
  silhouette_means = c(silhouette_means, mean(current_silhouette[,3]))
  wss_means = c(wss_means, mean(wss))
}
plot(2:20, silhouette_means, type="l", ylim=c(0,0.6))
plot(2:20, wss_means, type="l")
          
#dist.res <- dist(data, method = "euclidean")
#hc <- hclust(dist.res, method = "complete")
#k.max <- 20
#sil <- rep(0, k.max)

```

